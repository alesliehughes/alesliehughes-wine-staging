From 211c63701864ed4d06131a5b5944e59691437b65 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Mon, 31 Jul 2023 11:03:06 +1000
Subject: [PATCH 2/6] d3dx11_4[23]: Add D3DX11LoadTextureFromTexture stub

---
 dlls/d3dx11_42/d3dx11_42.spec | 2 +-
 dlls/d3dx11_43/d3dx11_43.spec | 2 +-
 dlls/d3dx11_43/texture.c      | 9 +++++++++
 include/d3dx11tex.h           | 2 ++
 4 files changed, 13 insertions(+), 2 deletions(-)

diff --git a/dlls/d3dx11_42/d3dx11_42.spec b/dlls/d3dx11_42/d3dx11_42.spec
index 99a38557b83..2d93b8d760a 100644
--- a/dlls/d3dx11_42/d3dx11_42.spec
+++ b/dlls/d3dx11_42/d3dx11_42.spec
@@ -32,7 +32,7 @@
 @ stdcall D3DX11GetImageInfoFromMemory(ptr long ptr ptr ptr)
 @ stub D3DX11GetImageInfoFromResourceA
 @ stub D3DX11GetImageInfoFromResourceW
-@ stub D3DX11LoadTextureFromTexture
+@ stdcall D3DX11LoadTextureFromTexture(ptr ptr ptr ptr)
 @ stub D3DX11PreprocessShaderFromFileA
 @ stub D3DX11PreprocessShaderFromFileW
 @ stub D3DX11PreprocessShaderFromMemory
diff --git a/dlls/d3dx11_43/d3dx11_43.spec b/dlls/d3dx11_43/d3dx11_43.spec
index 99a38557b83..2d93b8d760a 100644
--- a/dlls/d3dx11_43/d3dx11_43.spec
+++ b/dlls/d3dx11_43/d3dx11_43.spec
@@ -32,7 +32,7 @@
 @ stdcall D3DX11GetImageInfoFromMemory(ptr long ptr ptr ptr)
 @ stub D3DX11GetImageInfoFromResourceA
 @ stub D3DX11GetImageInfoFromResourceW
-@ stub D3DX11LoadTextureFromTexture
+@ stdcall D3DX11LoadTextureFromTexture(ptr ptr ptr ptr)
 @ stub D3DX11PreprocessShaderFromFileA
 @ stub D3DX11PreprocessShaderFromFileW
 @ stub D3DX11PreprocessShaderFromMemory
diff --git a/dlls/d3dx11_43/texture.c b/dlls/d3dx11_43/texture.c
index b91bd8d881a..7b8e740d42a 100644
--- a/dlls/d3dx11_43/texture.c
+++ b/dlls/d3dx11_43/texture.c
@@ -602,3 +602,12 @@ HRESULT WINAPI D3DX11SaveTextureToMemory(ID3D11DeviceContext *context, ID3D11Res
 
     return E_NOTIMPL;
 }
+
+HRESULT WINAPI D3DX11LoadTextureFromTexture(ID3D11DeviceContext *context, ID3D11Resource *src_texture,
+   D3DX11_TEXTURE_LOAD_INFO *info, ID3D11Resource *dst_texture)
+{
+    FIXME("context %p, src_texture %p, info %p, dst_texture %p stub!\n",
+            context, src_texture, info, dst_texture);
+
+    return E_NOTIMPL;
+}
diff --git a/include/d3dx11tex.h b/include/d3dx11tex.h
index 76c49ae1cbb..cf605ec3b66 100644
--- a/include/d3dx11tex.h
+++ b/include/d3dx11tex.h
@@ -155,6 +155,8 @@ HRESULT WINAPI D3DX11GetImageInfoFromFileW(const WCHAR *filename, ID3DX11ThreadP
         HRESULT *hresult);
 HRESULT WINAPI D3DX11GetImageInfoFromMemory(const void *src_data, SIZE_T src_data_size, ID3DX11ThreadPump *pump,
         D3DX11_IMAGE_INFO *img_info, HRESULT *hresult);
+HRESULT WINAPI D3DX11LoadTextureFromTexture(ID3D11DeviceContext *context, ID3D11Resource *src_texture,
+        D3DX11_TEXTURE_LOAD_INFO *info, ID3D11Resource *dst_texture);
 HRESULT WINAPI D3DX11SaveTextureToFileA(ID3D11DeviceContext *context, ID3D11Resource *texture,
         D3DX11_IMAGE_FILE_FORMAT format, const char *filename);
 HRESULT WINAPI D3DX11SaveTextureToFileW(ID3D11DeviceContext *context, ID3D11Resource *texture,
-- 
2.40.1

