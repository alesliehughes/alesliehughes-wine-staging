From 22c43bb47da554305e1ba046a411358493cc7789 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Thu, 9 May 2024 07:00:00 +1000
Subject: [PATCH] include: Add _ATL_INSECURE_DEPRECATE marco

---
 include/atldef.h | 36 ++++++++++++++++++++++++++++++++++++
 1 file changed, 36 insertions(+)

diff --git a/include/atldef.h b/include/atldef.h
index 700aded1137..86a1f876050 100644
--- a/include/atldef.h
+++ b/include/atldef.h
@@ -60,6 +60,42 @@
 /* Belongs elsewhere */
 #define ATLTRACE(...)
 
+#if defined(__GNUC__) || defined(__clang__)
+#define ATL_DEPRECATED(X) __attribute__((deprecated))
+#elif defined(_MSC_VER)
+#define ATL_DEPRECATED(X) __declspec(deprecated)
+#endif
+
+#ifndef _ATL_INSECURE_DEPRECATE
+#define _ATL_INSECURE_DEPRECATE(_Message)
+#endif
+
+#define ATLTRYALLOC(x) try { x; } catch(CException* e) { e->Delete(); }
+#define ATLTRY(x) ATLTRYALLOC(x)
+
+#ifndef _ATLTRY
+#define _ATLTRY try
+# ifdef _AFX
+#  define _ATLCATCH( e ) catch( CException* e )
+# else
+#  define _ATLCATCH( e ) catch( CAtlException e )
+#endif
+#endif
+
+#ifndef ATLENSURE_THROW
+#define ATLENSURE_THROW(expr, hr) \
+do { \
+    int condition=!!(expr); \
+    ATLASSUME(condition); \
+    if(!(condition)) AtlThrow(hr); \
+} while (0)
+#endif
+
+#ifndef ATLENSURE
+#define ATLENSURE(expr) ATLENSURE_THROW(expr, E_FAIL)
+#endif
+
+
 #define ATL_MAKEINTRESOURCEA(i) ((LPSTR)((ULONG_PTR)((WORD)(i))))
 #define ATL_MAKEINTRESOURCEW(i) ((LPWSTR)((ULONG_PTR)((WORD)(i))))
 #ifndef RC_INVOKED
-- 
2.43.0

