From 74e04053df689bb9227aa2877b47980799d83f0d Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Tue, 22 Jul 2025 12:06:15 +1000
Subject: [PATCH] oleaut32: Treat Interfaces with TYPEFLAG_FDISPATCHABLE flags
 as an IDispatch.

---
 dlls/oleaut32/typelib.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/dlls/oleaut32/typelib.c b/dlls/oleaut32/typelib.c
index 856e07c2811..cc0dc4f3c18 100644
--- a/dlls/oleaut32/typelib.c
+++ b/dlls/oleaut32/typelib.c
@@ -7917,7 +7917,8 @@ static HRESULT WINAPI ITypeInfo_fnGetRefTypeInfo(
         pTypeInfoImpl->ref = 0;
         list_init(&pTypeInfoImpl->custdata_list);
 
-        if (This->typeattr.typekind == TKIND_INTERFACE)
+        if (This->typeattr.typekind == TKIND_INTERFACE &&
+            This->typeattr.wTypeFlags & TYPEFLAG_FDISPATCHABLE)
             pTypeInfoImpl->typeattr.typekind = TKIND_DISPATCH;
         else
             pTypeInfoImpl->typeattr.typekind = TKIND_INTERFACE;
-- 
2.47.2

