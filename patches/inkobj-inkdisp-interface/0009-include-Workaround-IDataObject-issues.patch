From 87c65c4fe127157f5626fca0995641993035e5f0 Mon Sep 17 00:00:00 2001
From: Alistair Leslie-Hughes <leslie_alistair@hotmail.com>
Date: Wed, 10 Sep 2025 17:53:42 +1000
Subject: [PATCH] include: Workaround IDataObject issues

---
 dlls/inkobj/inkobj.c | 8 ++++----
 include/msinkaut.idl | 8 ++++----
 2 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/dlls/inkobj/inkobj.c b/dlls/inkobj/inkobj.c
index c9cc8494d56..4412cd0db58 100644
--- a/dlls/inkobj/inkobj.c
+++ b/dlls/inkobj/inkobj.c
@@ -306,7 +306,7 @@ static HRESULT WINAPI inkdisp_CreateStroke(IInkDisp *iface, VARIANT PacketData,
 }
 
 static HRESULT WINAPI inkdisp_ClipboardCopyWithRectangle(IInkDisp *iface, IInkRectangle *Rectangle, InkClipboardFormats ClipboardFormats,
-    InkClipboardModes ClipboardModes, IDataObject **DataObject)
+    InkClipboardModes ClipboardModes, /*IDataObject*/ IUnknown **DataObject)
 {
     struct ink_disp *ink_disp = impl_from_IInkDisp( iface );
 
@@ -316,7 +316,7 @@ static HRESULT WINAPI inkdisp_ClipboardCopyWithRectangle(IInkDisp *iface, IInkRe
 }
 
 static HRESULT WINAPI inkdisp_ClipboardCopy(IInkDisp *iface, IInkStrokes *strokes, InkClipboardFormats ClipboardFormats,
-    InkClipboardModes ClipboardModes, IDataObject **DataObject)
+    InkClipboardModes ClipboardModes, /*IDataObject*/ IUnknown **DataObject)
 {
     struct ink_disp *ink_disp = impl_from_IInkDisp( iface );
 
@@ -325,7 +325,7 @@ static HRESULT WINAPI inkdisp_ClipboardCopy(IInkDisp *iface, IInkStrokes *stroke
     return E_NOTIMPL;
 }
 
-static HRESULT WINAPI inkdisp_CanPaste(IInkDisp *iface, IDataObject *DataObject, VARIANT_BOOL *CanPaste)
+static HRESULT WINAPI inkdisp_CanPaste(IInkDisp *iface, /*IDataObject*/ IUnknown *DataObject, VARIANT_BOOL *CanPaste)
 {
     struct ink_disp *ink_disp = impl_from_IInkDisp( iface );
 
@@ -334,7 +334,7 @@ static HRESULT WINAPI inkdisp_CanPaste(IInkDisp *iface, IDataObject *DataObject,
     return E_NOTIMPL;
 }
 
-static HRESULT WINAPI inkdisp_ClipboardPaste(IInkDisp *iface, LONG x, LONG y, IDataObject *DataObject, IInkStrokes **Strokes)
+static HRESULT WINAPI inkdisp_ClipboardPaste(IInkDisp *iface, LONG x, LONG y, /*IDataObject*/ IUnknown *DataObject, IInkStrokes **Strokes)
 {
     struct ink_disp *ink_disp = impl_from_IInkDisp( iface );
 
diff --git a/include/msinkaut.idl b/include/msinkaut.idl
index beb7c5bb3fa..a8ead279647 100644
--- a/include/msinkaut.idl
+++ b/include/msinkaut.idl
@@ -693,19 +693,19 @@ cpp_quote("#endif /* _WINGDI_ */")
             [in] IInkRectangle *Rectangle,
             [in] InkClipboardFormats ClipboardFormats,
             [in] InkClipboardModes ClipboardModes,
-            [out, retval] IDataObject **DataObject);
+            [out, retval] /*IDataObject*/ IUnknown **DataObject);
         HRESULT ClipboardCopy(
             [in] IInkStrokes *strokes,
             [in] InkClipboardFormats ClipboardFormats,
             [in] InkClipboardModes ClipboardModes,
-            [out, retval] IDataObject **DataObject);
+            [out, retval] /*IDataObject*/ IUnknown **DataObject);
         HRESULT CanPaste(
-            [in] IDataObject *DataObject,
+            [in] /*IDataObject*/ IUnknown *DataObject,
             [out, retval] VARIANT_BOOL *CanPaste);
         HRESULT ClipboardPaste(
             [in] long x,
             [in] long y,
-            [in, unique] IDataObject *DataObject,
+            [in, unique] /*IDataObject*/ IUnknown *DataObject,
             [out, retval] IInkStrokes **Strokes);
     }
 
-- 
2.51.0

